---
title: "R Lab5"
output: html_notebook
---
r[binom](N, n, p) - случайнa величинa $x \in Bi(n, p)$ 
d - плътност
p, q - квантили $F_x(X < q) = p$


```{r}
  x = dbinom( 0 : 10, 10, 0.5)
  barplot(x)
```
```{r}
  barplot(dbinom( 0: 10, 10, 0.3))
```
Зад 1: Хвърлят се 30 зара. Каква е вероятността да се паднат по-малко от 5
шестици? Сравнете теоретичната вероятност с експериментални данни. Можем
да твърдим, че с вероятност 0,75 ще се паднат повече от колко шестици?
```{r}
#  [0, 5)
#  pbinom(4.99, 30, 1/6)
  pbinom(4, 30, 1/6)
# or... sum(dbinom( 0:4, 30, 1/6 ))
  for(k in 1:1000) {
    x = sample(1:6, replace = T, 30)
    p[k] = sum(x == 6)
  }
  sum(p < 5) / 1000
  qbinom(0.75, 30, 1/6, lower.tail = F)
```

Зад.2 Стрелец уцелва мишена с вероятност 0,2. За да спечели стрелецът
трябва да направи три точни попадения. Каква е вероятноста за това да са му
необходими:
$ x \in NB(n, p=0.2) $
а) точно 8 изстрела;
```{r}
  dnbinom(5, 3, 0.2)
```

б) повече от 6 изстрела;
```{r}
  pnbinom(3, 3, 0.2, lower.tail = F)
  1 - sum(dnbinom(0:3, 3, 0.2))
```

в) между 5 и 8 изстрела, включително?
```{r}
  pnbinom(5, 3, 0.2) - pnbinom(1.99, 3, 0.2)
  sum(dnbinom(2:5, 3, 0.2))
```

Зад.3 В урна има 7 бели и 6 черни топки. От урната последователно без
връщане се теглят 8 топки. Нека X е броя на изтеглените бели. Направете
1000 симулации и по тях пресметнете: границите, в който се мени X, EX и
DX. Намерете теоретичните стойности за EX и DX. Представете графично
емперичното и теоритичното разпределение на X(на една графика).

$hypergeometric\ distribution$
$$m\ -\ бели,\ n\ -\ черни,\ k\ -\ брой\ изтеглени,\ x\ -\ пром.\ бележеща\ броя\ на\ белите\ от\ изтеглените$$
```{r}
#  rhyper(m = 7, n = 6, k = 8)
  x = rhyper( 1000, m = 7, n = 6, k = 8 )
  min(x)
  max(x)
  mean(x)
  var(x)
  p = dhyper(2:7, m = 7, n = 6, k = 8)
  Ex = sum(p * 2:7)
  Ex
  Dx = sum((x - Ex)^2)/(length(x)-1)
  Dx
```
```{r}
  dim(p) = c(1, 6)
  p
  colnames(p) = 2:7
  p
```
```{r}
  barplot(p)
```
```{r}
  p2 = prop.table(table(x))
  barplot(rbind(p, p2), beside = T)
```

